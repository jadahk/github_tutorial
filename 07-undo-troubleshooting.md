# Git 되돌리기 & 문제 해결 가이드  
> *실수를 복구하는 능력은 개발자의 기본 역량이다*  
> 해당 문서는 문제가 생겼을 때 참고해 보는 것을 권한다.

Git과 GitHub는 여러가지 **실수를 안전하게 되돌리기 위해 설계된** 옵션과 명령어가 존재한다. 작업을 하면 분명히 실수를 하는 순간이 오기 마련, 중요한 것은  
- 실수를 안 하는 것이 아니라  
- **실수했을 때 어떻게 복구하느냐**다.



## 1. 되돌리기 전 반드시 거쳐야 할 판단 흐름

되돌리기 명령어를 선택하기 전에, 아래 3가지를 순서대로 확인한다.

### STEP 1. 변경 사항이 커밋 전인가, 후인가?
- 아직 `commit` 하지 않은 상태인가?
- 이미 `commit` 이 생성되었는가?

### STEP 2. 원격 저장소에 push 되었는가?
- 로컬에만 존재하는 커밋인가?
- GitHub 등 원격 저장소에 이미 공유되었는가?

### STEP 3. 협업에 영향을 주는가?
- 개인 브랜치인가?
- 공용 브랜치(`main`, `develop` 등)인가?

이 3단계를 구분하면 **사용 가능한 명령어가 자연스럽게 정해진다.**

---

## 2. 주요 복구 명령어 정리

### 파일 단위 되돌리기
```sh
git restore <파일경로>  
git restore --staged <파일경로>  
```
**역할**  
- 파일을 이전 상태로 복구
- 스테이징(add)만 취소 가능  

**사용 상황**
- add를 잘못했을 때
- 특정 파일만 원래 상태로 되돌리고 싶을 때

---

### 커밋 기준 상태 되돌리기 (로컬 전용)
```sh
git reset --soft HEAD~1  # 커밋만 취소 (파일·스테이징 유지)
git reset --mixed HEAD~1 # 커밋 + 스테이징 취소
git reset --hard HEAD~1  # 커밋 + 파일 변경 전부 삭제 (복구 불가)
```

**역할**
- HEAD 위치를 이동하여 커밋 상태를 되돌림

**사용 원칙**
- push 이전 로컬 작업에서만 사용
- 협업 브랜치에서는 사용하지 않음

---

###  안전한 되돌리기 (히스토리 유지)
```sh
- git revert <커밋해시>  
- git revert HEAD  
```
**역할**
- 기존 커밋을 취소하는 **새 커밋 생성**

**사용 상황**
- 이미 push된 커밋을 취소해야 할 때
- 팀 히스토리를 보존해야 할 때

---

### 최근 커밋 수정
```sh
git commit --amend  
```

**역할**
- 가장 최근 커밋을 수정
- 커밋 메시지 변경
- 누락된 파일 추가

**주의 사항**
- push 이전에만 사용 권장
- vi 편집기에서 동작하므로 기본 사용법 숙지 필요

---

### 병합 취소
```sh
git merge --abort  
```
**역할**
- merge 도중 충돌 발생 시
- 병합 이전 상태로 즉시 복구

**포인트**
- 충돌 해결이 복잡해질수록 즉시 abort 후 재시도하는 것이 안전


## 3. 상황별 빠른 선택 가이드 (암기용)

- add 취소 → git restore --staged  
- 최근 커밋 수정 → git commit --amend  
- 로컬 커밋 삭제 → git reset  
- push된 커밋 취소 → git revert  
- 작업 임시 저장 → git stash  
- 병합 중단 → git merge --abort  


## 4. 실무에서 반드시 지켜야 할 원칙

1. push 이후에는 reset을 사용하지 않는다  
2. 공용 브랜치에서는 revert만 사용한다  
3. hard reset은 “되돌릴 수 없음”을 전제로 사용한다  
4. 애매하면 먼저 commit을 남긴다 (커밋은 보험이다)  
5. merge가 꼬이면 빠르게 abort하고 다시 시도한다  
